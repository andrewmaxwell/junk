<body style="margin:0"><canvas></canvas><script>
with(document.body.childNodes[0])W=width=innerWidth,H=height=innerHeight,T=getContext('2d')
T.lineCap="round"

function roundedLine(p1, p2){
	T.beginPath()
	var dx=p2.x-p1.x, dy=p2.y-p1.y, dr=d=Math.sqrt(dx*dx+dy*dy)
	if (d<p1.r-p2.r) T.arc(p1.x, p1.y, p1.r, 0, Math.PI*2)
	else if (d<p2.r-p1.r) T.arc(p2.x, p2.y, p2.r, 0, Math.PI*2)
	else {
		var ang=Math.atan2(dy, dx), 
			a1=Math.PI/2+(p2.r-p1.r)/d
		T.arc(p1.x, p1.y, p1.r, ang+a1, ang-a1)
		T.arc(p2.x, p2.y, p2.r, ang-a1, ang+a1)
	}
	T.fill()
}

function grow(b, x, y){
	b.l=b.l?b.l+1/(1+b.l):.1
	var ex=x+b.l*Math.cos(b.a), ey=y+b.l*Math.sin(b.a), numDesc=0;
	if (!b.children && Math.random()<.01){
		b.children=[{a: b.a+Math.random()-.5, l: 1}, {a: b.a+Math.random()-.5, l: 1}]
	}
	for (var i=0; b.children && i<b.children.length; i++) numDesc+=grow(b.children[i], ex, ey)
	T.lineWidth=.3+Math.sqrt(numDesc)/5
	T.beginPath()
	T.moveTo(x, y)
	T.lineTo(ex, ey)
	T.stroke()
	return numDesc+1
}

var tree={a: -Math.PI/2}
setInterval(function(){
	T.clearRect(0,0,W,H)
	grow(tree, W/2, H)
},0)
</script>