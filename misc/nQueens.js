// const isValid = (board, colIndex) => {
//   for (let rowIndex = 0; rowIndex < board.length; rowIndex++) {
//     if (board[rowIndex] === colIndex) return false; // same column
//     if (board[rowIndex] + rowIndex - board.length === colIndex) return false; // diagonal left
//     if (board[rowIndex] - rowIndex + board.length === colIndex) return false; // diagonal right
//   }
//   return true;
// };

// const solveNQueens = (n, board = []) => {
//   if (board.length === n) {
//     return [
//       board.map((c) => `${'.'.repeat(c)}Q${'.'.repeat(board.length - 1 - c)}`),
//     ];
//   }

//   const solutions = [];
//   for (let colIndex = 0; colIndex < n; colIndex++) {
//     if (!isValid(board, colIndex)) continue;
//     board.push(colIndex);
//     solutions.push(...solveNQueens(n, board));
//     board.pop();
//   }
//   return solutions;
// };

const solve = (n, res = []) =>
  res.length === n
    ? [res.map((c) => '.'.repeat(c) + 'Q' + '.'.repeat(n - 1 - c))]
    : [...Array(n).keys()].flatMap((i) =>
        res.every((qi, ri) => qi !== i && Math.abs(qi - i) !== res.length - ri)
          ? solve(n, [...res, i])
          : []
      );

import {Test} from './test.js';
Test.assertDeepEquals(solve(5), [
  ['Q....', '..Q..', '....Q', '.Q...', '...Q.'],
  ['Q....', '...Q.', '.Q...', '....Q', '..Q..'],
  ['.Q...', '...Q.', 'Q....', '..Q..', '....Q'],
  ['.Q...', '....Q', '..Q..', 'Q....', '...Q.'],
  ['..Q..', 'Q....', '...Q.', '.Q...', '....Q'],
  ['..Q..', '....Q', '.Q...', '...Q.', 'Q....'],
  ['...Q.', 'Q....', '..Q..', '....Q', '.Q...'],
  ['...Q.', '.Q...', '....Q', '..Q..', 'Q....'],
  ['....Q', '.Q...', '...Q.', 'Q....', '..Q..'],
  ['....Q', '..Q..', 'Q....', '...Q.', '.Q...'],
]);

Test.assertDeepEquals(solve(8), [
  [
    'Q.......',
    '....Q...',
    '.......Q',
    '.....Q..',
    '..Q.....',
    '......Q.',
    '.Q......',
    '...Q....',
  ],
  [
    'Q.......',
    '.....Q..',
    '.......Q',
    '..Q.....',
    '......Q.',
    '...Q....',
    '.Q......',
    '....Q...',
  ],
  [
    'Q.......',
    '......Q.',
    '...Q....',
    '.....Q..',
    '.......Q',
    '.Q......',
    '....Q...',
    '..Q.....',
  ],
  [
    'Q.......',
    '......Q.',
    '....Q...',
    '.......Q',
    '.Q......',
    '...Q....',
    '.....Q..',
    '..Q.....',
  ],
  [
    '.Q......',
    '...Q....',
    '.....Q..',
    '.......Q',
    '..Q.....',
    'Q.......',
    '......Q.',
    '....Q...',
  ],
  [
    '.Q......',
    '....Q...',
    '......Q.',
    'Q.......',
    '..Q.....',
    '.......Q',
    '.....Q..',
    '...Q....',
  ],
  [
    '.Q......',
    '....Q...',
    '......Q.',
    '...Q....',
    'Q.......',
    '.......Q',
    '.....Q..',
    '..Q.....',
  ],
  [
    '.Q......',
    '.....Q..',
    'Q.......',
    '......Q.',
    '...Q....',
    '.......Q',
    '..Q.....',
    '....Q...',
  ],
  [
    '.Q......',
    '.....Q..',
    '.......Q',
    '..Q.....',
    'Q.......',
    '...Q....',
    '......Q.',
    '....Q...',
  ],
  [
    '.Q......',
    '......Q.',
    '..Q.....',
    '.....Q..',
    '.......Q',
    '....Q...',
    'Q.......',
    '...Q....',
  ],
  [
    '.Q......',
    '......Q.',
    '....Q...',
    '.......Q',
    'Q.......',
    '...Q....',
    '.....Q..',
    '..Q.....',
  ],
  [
    '.Q......',
    '.......Q',
    '.....Q..',
    'Q.......',
    '..Q.....',
    '....Q...',
    '......Q.',
    '...Q....',
  ],
  [
    '..Q.....',
    'Q.......',
    '......Q.',
    '....Q...',
    '.......Q',
    '.Q......',
    '...Q....',
    '.....Q..',
  ],
  [
    '..Q.....',
    '....Q...',
    '.Q......',
    '.......Q',
    'Q.......',
    '......Q.',
    '...Q....',
    '.....Q..',
  ],
  [
    '..Q.....',
    '....Q...',
    '.Q......',
    '.......Q',
    '.....Q..',
    '...Q....',
    '......Q.',
    'Q.......',
  ],
  [
    '..Q.....',
    '....Q...',
    '......Q.',
    'Q.......',
    '...Q....',
    '.Q......',
    '.......Q',
    '.....Q..',
  ],
  [
    '..Q.....',
    '....Q...',
    '.......Q',
    '...Q....',
    'Q.......',
    '......Q.',
    '.Q......',
    '.....Q..',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.Q......',
    '....Q...',
    '.......Q',
    'Q.......',
    '......Q.',
    '...Q....',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.Q......',
    '......Q.',
    'Q.......',
    '...Q....',
    '.......Q',
    '....Q...',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.Q......',
    '......Q.',
    '....Q...',
    'Q.......',
    '.......Q',
    '...Q....',
  ],
  [
    '..Q.....',
    '.....Q..',
    '...Q....',
    'Q.......',
    '.......Q',
    '....Q...',
    '......Q.',
    '.Q......',
  ],
  [
    '..Q.....',
    '.....Q..',
    '...Q....',
    '.Q......',
    '.......Q',
    '....Q...',
    '......Q.',
    'Q.......',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.......Q',
    'Q.......',
    '...Q....',
    '......Q.',
    '....Q...',
    '.Q......',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.......Q',
    'Q.......',
    '....Q...',
    '......Q.',
    '.Q......',
    '...Q....',
  ],
  [
    '..Q.....',
    '.....Q..',
    '.......Q',
    '.Q......',
    '...Q....',
    'Q.......',
    '......Q.',
    '....Q...',
  ],
  [
    '..Q.....',
    '......Q.',
    '.Q......',
    '.......Q',
    '....Q...',
    'Q.......',
    '...Q....',
    '.....Q..',
  ],
  [
    '..Q.....',
    '......Q.',
    '.Q......',
    '.......Q',
    '.....Q..',
    '...Q....',
    'Q.......',
    '....Q...',
  ],
  [
    '..Q.....',
    '.......Q',
    '...Q....',
    '......Q.',
    'Q.......',
    '.....Q..',
    '.Q......',
    '....Q...',
  ],
  [
    '...Q....',
    'Q.......',
    '....Q...',
    '.......Q',
    '.Q......',
    '......Q.',
    '..Q.....',
    '.....Q..',
  ],
  [
    '...Q....',
    'Q.......',
    '....Q...',
    '.......Q',
    '.....Q..',
    '..Q.....',
    '......Q.',
    '.Q......',
  ],
  [
    '...Q....',
    '.Q......',
    '....Q...',
    '.......Q',
    '.....Q..',
    'Q.......',
    '..Q.....',
    '......Q.',
  ],
  [
    '...Q....',
    '.Q......',
    '......Q.',
    '..Q.....',
    '.....Q..',
    '.......Q',
    'Q.......',
    '....Q...',
  ],
  [
    '...Q....',
    '.Q......',
    '......Q.',
    '..Q.....',
    '.....Q..',
    '.......Q',
    '....Q...',
    'Q.......',
  ],
  [
    '...Q....',
    '.Q......',
    '......Q.',
    '....Q...',
    'Q.......',
    '.......Q',
    '.....Q..',
    '..Q.....',
  ],
  [
    '...Q....',
    '.Q......',
    '.......Q',
    '....Q...',
    '......Q.',
    'Q.......',
    '..Q.....',
    '.....Q..',
  ],
  [
    '...Q....',
    '.Q......',
    '.......Q',
    '.....Q..',
    'Q.......',
    '..Q.....',
    '....Q...',
    '......Q.',
  ],
  [
    '...Q....',
    '.....Q..',
    'Q.......',
    '....Q...',
    '.Q......',
    '.......Q',
    '..Q.....',
    '......Q.',
  ],
  [
    '...Q....',
    '.....Q..',
    '.......Q',
    '.Q......',
    '......Q.',
    'Q.......',
    '..Q.....',
    '....Q...',
  ],
  [
    '...Q....',
    '.....Q..',
    '.......Q',
    '..Q.....',
    'Q.......',
    '......Q.',
    '....Q...',
    '.Q......',
  ],
  [
    '...Q....',
    '......Q.',
    'Q.......',
    '.......Q',
    '....Q...',
    '.Q......',
    '.....Q..',
    '..Q.....',
  ],
  [
    '...Q....',
    '......Q.',
    '..Q.....',
    '.......Q',
    '.Q......',
    '....Q...',
    'Q.......',
    '.....Q..',
  ],
  [
    '...Q....',
    '......Q.',
    '....Q...',
    '.Q......',
    '.....Q..',
    'Q.......',
    '..Q.....',
    '.......Q',
  ],
  [
    '...Q....',
    '......Q.',
    '....Q...',
    '..Q.....',
    'Q.......',
    '.....Q..',
    '.......Q',
    '.Q......',
  ],
  [
    '...Q....',
    '.......Q',
    'Q.......',
    '..Q.....',
    '.....Q..',
    '.Q......',
    '......Q.',
    '....Q...',
  ],
  [
    '...Q....',
    '.......Q',
    'Q.......',
    '....Q...',
    '......Q.',
    '.Q......',
    '.....Q..',
    '..Q.....',
  ],
  [
    '...Q....',
    '.......Q',
    '....Q...',
    '..Q.....',
    'Q.......',
    '......Q.',
    '.Q......',
    '.....Q..',
  ],
  [
    '....Q...',
    'Q.......',
    '...Q....',
    '.....Q..',
    '.......Q',
    '.Q......',
    '......Q.',
    '..Q.....',
  ],
  [
    '....Q...',
    'Q.......',
    '.......Q',
    '...Q....',
    '.Q......',
    '......Q.',
    '..Q.....',
    '.....Q..',
  ],
  [
    '....Q...',
    'Q.......',
    '.......Q',
    '.....Q..',
    '..Q.....',
    '......Q.',
    '.Q......',
    '...Q....',
  ],
  [
    '....Q...',
    '.Q......',
    '...Q....',
    '.....Q..',
    '.......Q',
    '..Q.....',
    'Q.......',
    '......Q.',
  ],
  [
    '....Q...',
    '.Q......',
    '...Q....',
    '......Q.',
    '..Q.....',
    '.......Q',
    '.....Q..',
    'Q.......',
  ],
  [
    '....Q...',
    '.Q......',
    '.....Q..',
    'Q.......',
    '......Q.',
    '...Q....',
    '.......Q',
    '..Q.....',
  ],
  [
    '....Q...',
    '.Q......',
    '.......Q',
    'Q.......',
    '...Q....',
    '......Q.',
    '..Q.....',
    '.....Q..',
  ],
  [
    '....Q...',
    '..Q.....',
    'Q.......',
    '.....Q..',
    '.......Q',
    '.Q......',
    '...Q....',
    '......Q.',
  ],
  [
    '....Q...',
    '..Q.....',
    'Q.......',
    '......Q.',
    '.Q......',
    '.......Q',
    '.....Q..',
    '...Q....',
  ],
  [
    '....Q...',
    '..Q.....',
    '.......Q',
    '...Q....',
    '......Q.',
    'Q.......',
    '.....Q..',
    '.Q......',
  ],
  [
    '....Q...',
    '......Q.',
    'Q.......',
    '..Q.....',
    '.......Q',
    '.....Q..',
    '...Q....',
    '.Q......',
  ],
  [
    '....Q...',
    '......Q.',
    'Q.......',
    '...Q....',
    '.Q......',
    '.......Q',
    '.....Q..',
    '..Q.....',
  ],
  [
    '....Q...',
    '......Q.',
    '.Q......',
    '...Q....',
    '.......Q',
    'Q.......',
    '..Q.....',
    '.....Q..',
  ],
  [
    '....Q...',
    '......Q.',
    '.Q......',
    '.....Q..',
    '..Q.....',
    'Q.......',
    '...Q....',
    '.......Q',
  ],
  [
    '....Q...',
    '......Q.',
    '.Q......',
    '.....Q..',
    '..Q.....',
    'Q.......',
    '.......Q',
    '...Q....',
  ],
  [
    '....Q...',
    '......Q.',
    '...Q....',
    'Q.......',
    '..Q.....',
    '.......Q',
    '.....Q..',
    '.Q......',
  ],
  [
    '....Q...',
    '.......Q',
    '...Q....',
    'Q.......',
    '..Q.....',
    '.....Q..',
    '.Q......',
    '......Q.',
  ],
  [
    '....Q...',
    '.......Q',
    '...Q....',
    'Q.......',
    '......Q.',
    '.Q......',
    '.....Q..',
    '..Q.....',
  ],
  [
    '.....Q..',
    'Q.......',
    '....Q...',
    '.Q......',
    '.......Q',
    '..Q.....',
    '......Q.',
    '...Q....',
  ],
  [
    '.....Q..',
    '.Q......',
    '......Q.',
    'Q.......',
    '..Q.....',
    '....Q...',
    '.......Q',
    '...Q....',
  ],
  [
    '.....Q..',
    '.Q......',
    '......Q.',
    'Q.......',
    '...Q....',
    '.......Q',
    '....Q...',
    '..Q.....',
  ],
  [
    '.....Q..',
    '..Q.....',
    'Q.......',
    '......Q.',
    '....Q...',
    '.......Q',
    '.Q......',
    '...Q....',
  ],
  [
    '.....Q..',
    '..Q.....',
    'Q.......',
    '.......Q',
    '...Q....',
    '.Q......',
    '......Q.',
    '....Q...',
  ],
  [
    '.....Q..',
    '..Q.....',
    'Q.......',
    '.......Q',
    '....Q...',
    '.Q......',
    '...Q....',
    '......Q.',
  ],
  [
    '.....Q..',
    '..Q.....',
    '....Q...',
    '......Q.',
    'Q.......',
    '...Q....',
    '.Q......',
    '.......Q',
  ],
  [
    '.....Q..',
    '..Q.....',
    '....Q...',
    '.......Q',
    'Q.......',
    '...Q....',
    '.Q......',
    '......Q.',
  ],
  [
    '.....Q..',
    '..Q.....',
    '......Q.',
    '.Q......',
    '...Q....',
    '.......Q',
    'Q.......',
    '....Q...',
  ],
  [
    '.....Q..',
    '..Q.....',
    '......Q.',
    '.Q......',
    '.......Q',
    '....Q...',
    'Q.......',
    '...Q....',
  ],
  [
    '.....Q..',
    '..Q.....',
    '......Q.',
    '...Q....',
    'Q.......',
    '.......Q',
    '.Q......',
    '....Q...',
  ],
  [
    '.....Q..',
    '...Q....',
    'Q.......',
    '....Q...',
    '.......Q',
    '.Q......',
    '......Q.',
    '..Q.....',
  ],
  [
    '.....Q..',
    '...Q....',
    '.Q......',
    '.......Q',
    '....Q...',
    '......Q.',
    'Q.......',
    '..Q.....',
  ],
  [
    '.....Q..',
    '...Q....',
    '......Q.',
    'Q.......',
    '..Q.....',
    '....Q...',
    '.Q......',
    '.......Q',
  ],
  [
    '.....Q..',
    '...Q....',
    '......Q.',
    'Q.......',
    '.......Q',
    '.Q......',
    '....Q...',
    '..Q.....',
  ],
  [
    '.....Q..',
    '.......Q',
    '.Q......',
    '...Q....',
    'Q.......',
    '......Q.',
    '....Q...',
    '..Q.....',
  ],
  [
    '......Q.',
    'Q.......',
    '..Q.....',
    '.......Q',
    '.....Q..',
    '...Q....',
    '.Q......',
    '....Q...',
  ],
  [
    '......Q.',
    '.Q......',
    '...Q....',
    'Q.......',
    '.......Q',
    '....Q...',
    '..Q.....',
    '.....Q..',
  ],
  [
    '......Q.',
    '.Q......',
    '.....Q..',
    '..Q.....',
    'Q.......',
    '...Q....',
    '.......Q',
    '....Q...',
  ],
  [
    '......Q.',
    '..Q.....',
    'Q.......',
    '.....Q..',
    '.......Q',
    '....Q...',
    '.Q......',
    '...Q....',
  ],
  [
    '......Q.',
    '..Q.....',
    '.......Q',
    '.Q......',
    '....Q...',
    'Q.......',
    '.....Q..',
    '...Q....',
  ],
  [
    '......Q.',
    '...Q....',
    '.Q......',
    '....Q...',
    '.......Q',
    'Q.......',
    '..Q.....',
    '.....Q..',
  ],
  [
    '......Q.',
    '...Q....',
    '.Q......',
    '.......Q',
    '.....Q..',
    'Q.......',
    '..Q.....',
    '....Q...',
  ],
  [
    '......Q.',
    '....Q...',
    '..Q.....',
    'Q.......',
    '.....Q..',
    '.......Q',
    '.Q......',
    '...Q....',
  ],
  [
    '.......Q',
    '.Q......',
    '...Q....',
    'Q.......',
    '......Q.',
    '....Q...',
    '..Q.....',
    '.....Q..',
  ],
  [
    '.......Q',
    '.Q......',
    '....Q...',
    '..Q.....',
    'Q.......',
    '......Q.',
    '...Q....',
    '.....Q..',
  ],
  [
    '.......Q',
    '..Q.....',
    'Q.......',
    '.....Q..',
    '.Q......',
    '....Q...',
    '......Q.',
    '...Q....',
  ],
  [
    '.......Q',
    '...Q....',
    'Q.......',
    '..Q.....',
    '.....Q..',
    '.Q......',
    '......Q.',
    '....Q...',
  ],
]);

// 1, 0, 0, 2, 10, 4, 40, 92, 352, 724, 2680, 14200
